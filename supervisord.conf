[supervisord]
nodaemon=true
user=root
logfile=/dev/null
pidfile=/tmp/supervisord.pid

# Playit: Run interactively so claim link streams to logs
[program:playit]
command=/usr/local/bin/playit
directory=/app
autostart=true
autorestart=false
startretries=3
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
stdout_events_enabled=true
priority=1

# Bedrock: Wait for Playit to establish tunnel (optional delay)
[program:bedrock]
command=bash -c "sleep 2 && /app/bedrock/bedrock_server"
directory=/app/bedrock
environment=LD_LIBRARY_PATH="/app/bedrock"
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=2

# HTTP Health Check (keeps Render alive)
[program:http]
command=python3 -u /app/http.py
autostart=true
autorestart=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
priority=3